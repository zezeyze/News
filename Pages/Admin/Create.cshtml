@page
@model NewsPage.Pages.Admin.CreateModel
@{
    ViewData["Title"] = "Yeni Haber Ekle";
}

<form method="post" enctype="multipart/form-data" id="form">
    <div class="form-group">
        <input type="text" class="form-control" id="title" name="Title" placeholder="Başlık" />
    </div>
    <div class="form-group">
        <input type="text" class="form-control" id="summary" name="Summary" placeholder="Özeti" />
    </div>
    <div class="form-group">
        <textarea id="content" name="Content"></textarea>
    </div>
    <div class="form-group">
        <input type="file" class="form-control" name="Resim" />
    </div>
    <div class="btn-group-toggle">
        <button type="button" onclick="Save()" class="shadow__btn">Kaydet</button>
    </div>
  
</form>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.16/dist/summernote.min.css" rel="stylesheet" />

    <script>
        $(document).ready(function () {
            $('#content').summernote();
        });

        function Save() {
            var form = document.getElementById("form");
            var formData = new FormData(form);

            // Summernote içeriğini formData’ya ekle
            var content = $('#content').summernote('code');
            formData.set("Content", content);

            fetch("/Admin/Create?handler=Save", {
                method: "POST",
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert("Haber kaydedildi!");
                    location.href = "/Admin/Index"; // Başarılıysa liste sayfasına yönlendir
                } else {
                    alert("Hata oluştu: " + (data.message || ""));
                }
            })
            .catch(() => alert("İstek sırasında hata oluştu."));
        }
        
    </script>
}

<style>
    .shadow__btn {
        padding: 5px 12px;
        border: none;
        font-size: 14px;
        color: #fff;
        border-radius: 7px;
        letter-spacing: 1px;
        font-weight: 600;
        text-transform: uppercase;
        background: rgb(47, 170, 150);
        box-shadow: 0 0 25px rgb(47, 170, 150);
        transition: 0.5s;
        transition-property: box-shadow;
        display: inline-block;
    }

        .shadow__btn:hover {
            box-shadow: 0 0 5px rgb(47, 170, 150), 0 0 25px rgb(47, 170, 150), 0 0 50px rgb(47, 170, 150), 0 0 100px rgb(47, 170, 150);
        }
</style>
